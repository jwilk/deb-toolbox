#!/bin/sh

# Copyright Â© 2017-2022 Jakub Wilk <jwilk@jwilk.net>
# SPDX-License-Identifier: MIT

set -e -u

urlescape()
{
    perl -E '$_ = $ARGV[0]; s/[^\w.-]/sprintf "%%%02X", ord $&/ge; say $_' "$@"
}

if [ $# -ne 1 ]
then
    printf 'Usage: %s PACKAGE\n' "${0##*/}" >&2
    exit 1
fi

pkg="$1"
pkg=$(apt-cache showsrc -- "$pkg" | grep-dctrl -ns Package '' | sort -u)
upkg=$(urlescape "$pkg")
url="https://buildd.debian.org/status/package.php?p=$upkg"
exec sensible-browser "$url"

# vim:ts=4 sts=4 sw=4 et
